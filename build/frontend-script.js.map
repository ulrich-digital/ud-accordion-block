{"version":3,"file":"frontend-script.js","mappings":"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","sources":["webpack://accordion-block-ud/./src/js/frontend.js"],"sourcesContent":["/* =============================================================== *\\\n   Accordion-Block (finale Version mit Grow/Shrink-Fix)\n   Zweck: Interaktive Accordion-Komponente mit animierter Höhe\n   Architektur: Bottom-up / selbstbeobachtend\n   Reagiert auf:\n       - Klicks auf die eigene Toggle-Fläche\n       - externe Klassenänderungen (z. B. durch CMS oder JS)\n       - Resize-Events innerhalb des Inhalts\n   Unterstützt verschachtelte Accordions\n   Umsetzung mit max-height und Transition\n\n   Voraussetzungen:\n       - Jedes Accordion-Element braucht eine feste Struktur:\n         .ud-accordion\n           > .ud-accordion__title\n           > .ud-accordion__content\n             > .ud-accordion__content-inner\n\\* =============================================================== */\n\n\n/* =============================================================== *\\\n   UD Accordion Block – optimierte Version (Firefox Performance Fix)\n   - Minimiert Reflows durch gecachtes scrollHeight\n   - Throttled ResizeObserver\n   - Kürzere, weichere Transition\n   - Gleiches Verhalten / API wie bisher\n\\* =============================================================== */\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\t// Entferne leere Accordions\n\tdocument.querySelectorAll(\".ud-accordion\").forEach((accordion) => {\n\t\tconst inner = accordion.querySelector(\".ud-accordion__content-inner\");\n\t\tif (!inner) return;\n\n\t\tconst contentText = inner.textContent.trim();\n\t\tconst hasOnlyEmptyBlocks = inner.innerHTML\n\t\t\t.replace(/<[^\\/>][^>]*><\\/[^>]+>/gi, \"\")\n\t\t\t.trim() === \"\";\n\n\t\tif (contentText === \"\" || hasOnlyEmptyBlocks) {\n\t\t\taccordion.remove();\n\t\t}\n\t});\n\n\tconst allAccordions = [...document.querySelectorAll(\".ud-accordion\")];\n\tconst sortedAccordions = allAccordions.sort((a, b) =>\n\t\ta.contains(b) ? 1 : b.contains(a) ? -1 : 0\n\t);\n\n\tsortedAccordions.forEach((accordion, index) => {\n\t\tconst toggleArea = accordion.querySelector(\":scope > .ud-accordion__title\");\n\t\tconst content = accordion.querySelector(\":scope > .ud-accordion__content\");\n\t\tconst icon = accordion.querySelector(\":scope > .ud-accordion__title > .ud-accordion__icon\");\n\n\t\tif (!toggleArea || !content) {\n\t\t\tconsole.warn(`[Accordion ${index}] ❌ Ungültige Struktur – wird übersprungen`);\n\t\t\treturn;\n\t\t}\n\n\t\t// 🧩 Hilfsfunktionen\n\t\tconst setMaxHeight = (h = null) => {\n\t\t\tconst fullHeight = h ?? content.scrollHeight;\n\t\t\tcontent.style.maxHeight = fullHeight + \"px\";\n\t\t};\n\t\tconst close = () => (content.style.maxHeight = \"0px\");\n\n\t\tconst updateState = () => {\n\t\t\tconst isOpen = accordion.classList.contains(\"is-open\");\n\t\t\ttoggleArea.setAttribute(\"aria-expanded\", String(isOpen));\n\t\t\ticon?.classList.toggle(\"is-open\", isOpen);\n\t\t\tif (isOpen) setMaxHeight();\n\t\t\telse close();\n\t\t};\n\n\t\tconst updateAncestors = (element, childHeight = null) => {\n\t\t\tlet parent = element.parentElement;\n\t\t\twhile (parent) {\n\t\t\t\tif (parent.classList.contains(\"ud-accordion\") && parent.classList.contains(\"is-open\")) {\n\t\t\t\t\tconst parentContent = parent.querySelector(\":scope > .ud-accordion__content\");\n\t\t\t\t\tif (parentContent) {\n\t\t\t\t\t\tconst h = parentContent.scrollHeight;\n\t\t\t\t\t\tparentContent.style.maxHeight = h + \"px\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparent = parent.parentElement;\n\t\t\t}\n\t\t};\n\n\t\t// 🧠 Klick-Handler\n\t\ttoggleArea.addEventListener(\"click\", (e) => {\n\t\t\te.preventDefault();\n\t\t\tconst isOpen = accordion.classList.toggle(\"is-open\");\n\t\t\tif (isOpen) {\n\t\t\t\tconst h = content.scrollHeight;\n\t\t\t\tsetMaxHeight(h);\n\t\t\t\tupdateAncestors(accordion, h);\n\t\t\t} else {\n\t\t\t\tclose();\n\t\t\t\tupdateAncestors(accordion);\n\t\t\t}\n\t\t});\n\n\t\t// 🧩 MutationObserver (externe Klassenänderungen)\n\t\tconst mutationObserver = new MutationObserver((mutations) => {\n\t\t\tfor (const m of mutations) {\n\t\t\t\tif (m.type === \"attributes\" && m.attributeName === \"class\") {\n\t\t\t\t\tupdateState();\n\t\t\t\t\tupdateAncestors(accordion);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tmutationObserver.observe(accordion, { attributes: true });\n\n\t\t// 🧩 ResizeObserver – throttled (Firefox-friendly)\n\t\tlet resizeTimeout;\n\t\tconst resizeObserver = new ResizeObserver(() => {\n\t\t\tclearTimeout(resizeTimeout);\n\t\t\tresizeTimeout = setTimeout(() => {\n\t\t\t\tif (accordion.classList.contains(\"is-open\")) {\n\t\t\t\t\tconst h = content.scrollHeight;\n\t\t\t\t\tsetMaxHeight(h);\n\t\t\t\t\tupdateAncestors(accordion, h);\n\t\t\t\t}\n\t\t\t}, 80);\n\t\t});\n\t\tresizeObserver.observe(content);\n\n\t\tupdateState();\n\t});\n\n\n\n\n/* === FluentForm-Integration: Accordion-Höhenanpassung === */\n/* === FluentForm-Integration: stabile Accordion-Höhenanpassung === */\n\n// 🔹 Funktion zur Neuberechnung aller offenen Accordions\nconst recalcAllAccordions = () => {\n\tdocument.querySelectorAll(\".ud-accordion.is-open\").forEach((accordion) => {\n\t\tconst content = accordion.querySelector(\":scope > .ud-accordion__content\");\n\t\tif (content) {\n\t\t\tcontent.style.maxHeight = content.scrollHeight + \"px\";\n\n\t\t\t// Verschachtelte Eltern mitaktualisieren\n\t\t\tlet parent = accordion.parentElement;\n\t\t\twhile (parent) {\n\t\t\t\tif (\n\t\t\t\t\tparent.classList.contains(\"ud-accordion\") &&\n\t\t\t\t\tparent.classList.contains(\"is-open\")\n\t\t\t\t) {\n\t\t\t\t\tconst parentContent = parent.querySelector(\":scope > .ud-accordion__content\");\n\t\t\t\t\tif (parentContent) {\n\t\t\t\t\t\tparentContent.style.maxHeight = parentContent.scrollHeight + \"px\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparent = parent.parentElement;\n\t\t\t}\n\t\t}\n\t});\n};\n\n// 🔹 Stabiler Beobachter (Polling für max. 1 Sekunde)\nconst triggerAccordionRecalc = () => {\n\tlet elapsed = 0;\n\tconst interval = setInterval(() => {\n\t\trecalcAllAccordions();\n\t\telapsed += 100;\n\t\tif (elapsed >= 1000) clearInterval(interval);\n\t}, 100);\n};\n\n// 🔹 Klicks auf Next/Prev in FluentForm\ndocument.addEventListener(\"click\", (e) => {\n\tif (e.target.closest(\".ff-btn-next\") || e.target.closest(\".ff-btn-prev\")) {\n\t\ttriggerAccordionRecalc();\n\t}\n});\n\n// 🔹 Reaktion auf Radio-/Checkbox-Wechsel in FluentForm\ndocument.addEventListener(\"change\", (e) => {\n\tif (e.target.closest(\".fluentform\")) {\n\t\ttriggerAccordionRecalc();\n\t}\n});\n\n\n\n});\n"],"names":["document","addEventListener","querySelectorAll","forEach","accordion","inner","querySelector","contentText","textContent","trim","hasOnlyEmptyBlocks","innerHTML","replace","remove","allAccordions","sortedAccordions","sort","a","b","contains","index","toggleArea","content","icon","console","warn","setMaxHeight","h","fullHeight","scrollHeight","style","maxHeight","close","updateState","isOpen","classList","setAttribute","String","toggle","updateAncestors","element","childHeight","parent","parentElement","parentContent","e","preventDefault","mutationObserver","MutationObserver","mutations","m","type","attributeName","observe","attributes","resizeTimeout","resizeObserver","ResizeObserver","clearTimeout","setTimeout","recalcAllAccordions","triggerAccordionRecalc","elapsed","interval","setInterval","clearInterval","target","closest"],"sourceRoot":""}